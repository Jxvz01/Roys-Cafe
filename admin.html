<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roy's Cafe — Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/admin.css">
</head>

<body>

    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="login-screen">
        <div class="login-card">
            <div class="login-brand">
                <div class="login-brand-icon">
                    <i class="fas fa-leaf"></i>
                </div>
                <div class="login-logo-text">ROY'S</div>
                <div class="login-logo-sub">Cafe Admin Panel</div>
            </div>
            <div id="login-error" class="login-error hidden"></div>
            <div class="form-group">
                <label>Email</label>
                <div class="input-wrap">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="login-email" placeholder="admin@example.com" autocomplete="email">
                </div>
            </div>
            <div class="form-group">
                <label>Password</label>
                <div class="input-wrap">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="login-pass" placeholder="Your password" autocomplete="current-password">
                    <button type="button" id="toggle-pass" class="toggle-pass"><i class="fas fa-eye"></i></button>
                </div>
            </div>
            <button id="login-btn" class="btn-admin-primary full-width">
                <i class="fas fa-sign-in-alt"></i> Sign In
            </button>
            <p class="login-hint">Use the credentials from your Supabase Auth dashboard.</p>
        </div>
    </div>

    <!-- ADMIN APP -->
    <div id="admin-app" class="admin-app hidden">

        <!-- SIDEBAR -->
        <aside class="admin-sidebar">
            <div class="sidebar-brand">
                <div class="sidebar-brand-icon">
                    <i class="fas fa-leaf"></i>
                </div>
                <div class="brand-labels">
                    <span class="brand-main">ROY'S</span>
                    <span class="brand-sub">Admin</span>
                </div>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-section="dashboard">
                    <i class="fas fa-chart-pie"></i> Dashboard
                </a>
                <a href="#" class="nav-item" data-section="menu">
                    <i class="fas fa-utensils"></i> Menu
                </a>
                <a href="#" class="nav-item" data-section="gallery">
                    <i class="fas fa-images"></i> Gallery
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="index.html" target="_blank" class="sidebar-link">
                    <i class="fas fa-external-link-alt"></i> View Site
                </a>
                <button id="logout-btn" class="sidebar-link logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="admin-main">
            <div class="admin-topbar">
                <h1 id="page-title" class="page-title">Dashboard</h1>
                <div class="topbar-actions" id="topbar-actions"></div>
            </div>

            <!-- DASHBOARD -->
            <section id="section-dashboard" class="admin-section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-list"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="stat-categories">—</span>
                            <span class="stat-label">Categories</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-mug-hot"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="stat-items">—</span>
                            <span class="stat-label">Menu Items</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-image"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="stat-gallery">—</span>
                            <span class="stat-label">Gallery Images</span>
                        </div>
                    </div>
                </div>
                <div class="info-card">
                    <h3><i class="fas fa-globe"></i> Live &amp; Global</h3>
                    <p>All changes are saved to Supabase and are <strong>instantly visible to every visitor</strong>
                        worldwide. Menu and gallery updates go live as soon as you save them — no refresh needed on
                        the visitor's side.</p>
                </div>
            </section>

            <!-- MENU -->
            <section id="section-menu" class="admin-section">
                <div class="section-toolbar">
                    <div class="category-tabs" id="category-tabs"></div>
                    <div class="toolbar-right">
                        <button class="btn-admin-secondary" id="add-category-btn">
                            <i class="fas fa-folder-plus"></i> Add Category
                        </button>
                        <button class="btn-admin-primary" id="add-item-btn">
                            <i class="fas fa-plus"></i> Add Item
                        </button>
                    </div>
                </div>
                <div id="menu-items-grid" class="items-grid"></div>
            </section>

            <!-- GALLERY -->
            <section id="section-gallery" class="admin-section">
                <div id="gallery-grid-admin" class="gallery-admin-grid"></div>
            </section>
        </main>
    </div>

    <!-- MODALS -->

    <!-- Add/Edit Menu Item -->
    <div id="item-modal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h2 id="item-modal-title">Add Menu Item</h2>
                <button class="modal-close" data-close="item-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="item-id">
                <input type="hidden" id="item-category-id">
                <input type="hidden" id="item-existing-image">
                <div class="form-group">
                    <label>Item Name *</label>
                    <input type="text" id="item-name" placeholder="e.g. Flat White" class="form-input">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Price *</label>
                        <input type="text" id="item-price" placeholder="e.g. ₹120" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Tag (optional)</label>
                        <input type="text" id="item-tag" placeholder="e.g. Popular" class="form-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>Description *</label>
                    <textarea id="item-desc" rows="3" placeholder="Brief description..." class="form-input"></textarea>
                </div>
                <div class="form-group">
                    <label>Item Image (optional)</label>
                    <div class="upload-zone" id="item-upload-zone">
                        <input type="file" id="item-image-file"
                            accept="image/jpeg,image/jpg,image/png,image/webp,image/heic,image/heif" class="hidden">
                        <div class="upload-prompt" id="item-upload-prompt">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Drop image here or <label for="item-image-file" class="upload-link">browse
                                    files</label></span>
                            <span class="upload-hint">JPG · PNG · WebP · HEIC</span>
                        </div>
                        <div id="item-image-preview-wrap" class="upload-preview hidden">
                            <img id="item-preview-img" src="" alt="Preview">
                            <button type="button" class="remove-preview-btn" id="remove-item-image">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div id="item-upload-progress" class="upload-progress hidden">
                            <div class="progress-bar">
                                <div class="progress-fill" id="item-progress-fill"></div>
                            </div>
                            <span id="item-upload-status">Uploading...</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-admin-ghost" data-close="item-modal">Cancel</button>
                <button class="btn-admin-primary" id="save-item-btn"><i class="fas fa-save"></i> Save Item</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Category -->
    <div id="category-modal" class="modal-overlay hidden">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2 id="category-modal-title">Add Category</h2>
                <button class="modal-close" data-close="category-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="category-edit-id">
                <div class="form-group">
                    <label>Category Name *</label>
                    <input type="text" id="category-name" placeholder="e.g. Cold Brews" class="form-input">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-admin-ghost" data-close="category-modal">Cancel</button>
                <button class="btn-admin-primary" id="save-category-btn"><i class="fas fa-save"></i> Save</button>
            </div>
        </div>
    </div>

    <!-- Add Gallery Image -->
    <div id="gallery-modal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h2>Add Gallery Image</h2>
                <button class="modal-close" data-close="gallery-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <!-- Tab toggle -->
                <div class="upload-tabs">
                    <button class="upload-tab active" data-tab="upload">Upload File</button>
                    <button class="upload-tab" data-tab="url">Use URL</button>
                </div>

                <!-- Upload tab -->
                <div id="tab-upload">
                    <div class="upload-zone" id="gallery-upload-zone">
                        <input type="file" id="gallery-image-file"
                            accept="image/jpeg,image/jpg,image/png,image/webp,image/heic,image/heif" class="hidden">
                        <div class="upload-prompt" id="gallery-upload-prompt">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Drop image here or <label for="gallery-image-file" class="upload-link">browse
                                    files</label></span>
                            <span class="upload-hint">JPG · PNG · WebP · HEIC — Max 10MB</span>
                        </div>
                        <div id="gallery-file-preview-wrap" class="upload-preview hidden">
                            <img id="gallery-file-preview-img" src="" alt="Preview">
                            <button type="button" class="remove-preview-btn" id="remove-gallery-file">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div id="gallery-upload-progress" class="upload-progress hidden">
                            <div class="progress-bar">
                                <div class="progress-fill" id="gallery-progress-fill"></div>
                            </div>
                            <span id="gallery-upload-status">Uploading...</span>
                        </div>
                    </div>
                </div>

                <!-- URL tab -->
                <div id="tab-url" class="hidden">
                    <div class="form-group" style="margin-top:16px">
                        <label>Image URL</label>
                        <input type="url" id="gallery-url" placeholder="https://images.unsplash.com/..."
                            class="form-input">
                    </div>
                    <div id="url-preview-wrap" class="upload-preview hidden" style="margin-top:12px;max-height:200px">
                        <img id="url-preview-img" src="" alt="Preview" style="height:200px">
                    </div>
                    <button class="btn-admin-secondary" id="preview-url-btn" style="margin-top:10px">
                        <i class="fas fa-eye"></i> Preview URL
                    </button>
                </div>

                <div class="form-group" style="margin-top:20px">
                    <label>Alt Text (description)</label>
                    <input type="text" id="gallery-alt" placeholder="e.g. Morning coffee setup" class="form-input">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-admin-ghost" data-close="gallery-modal">Cancel</button>
                <button class="btn-admin-primary" id="save-gallery-btn">
                    <i class="fas fa-plus"></i> Add to Gallery
                </button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete -->
    <div id="confirm-modal" class="modal-overlay hidden">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2><i class="fas fa-exclamation-triangle" style="color:#ff7b72"></i> Confirm Delete</h2>
                <button class="modal-close" data-close="confirm-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <p id="confirm-message" style="color:var(--admin-text-muted);font-size:0.9rem;line-height:1.6;">Are you
                    sure?</p>
            </div>
            <div class="modal-footer">
                <button class="btn-admin-ghost" data-close="confirm-modal">Cancel</button>
                <button class="btn-admin-danger" id="confirm-delete-btn">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast hidden"></div>

    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/admin.js"></script>
</body>

</html>